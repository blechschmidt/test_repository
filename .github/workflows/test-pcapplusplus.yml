name: Test — PcapPlusPlus (all releases)

# Verifies artifact attestations across every release of seladb/PcapPlusPlus.
# The latest release (v25.05) uses GitHub attestations and passes.
# Older releases are expected to fail, triggering automatic issue creation.

on:
  workflow_dispatch:
  push:
    branches: [main]

jobs:
  verify-all-releases:
    name: Verify all PcapPlusPlus releases
    uses: blechschmidt/aritfact-attestation-verification-action/.github/workflows/verify-attestations.yml@main
    with:
      repository: seladb/PcapPlusPlus
      # No tag → checks every release
      open-issue: true
    permissions:
      contents: read
      issues: write
